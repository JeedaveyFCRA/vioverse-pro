<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIOVERSE Professional - Diagnostic</title>

    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .status { margin: 10px 0; padding: 10px; border: 1px solid #333; }
        .success { background: #0f4c0f; }
        .error { background: #4c0f0f; }
        .warning { background: #4c4c0f; }
    </style>
</head>
<body>
    <h1>VIOVERSE Professional - Diagnostic Page</h1>
    <div id="status"></div>

    <script>
        const statusDiv = document.getElementById('status');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<strong>${type.toUpperCase()}:</strong> ${message}`;
            statusDiv.appendChild(div);
        }

        // Test 1: Check if page loads
        log('Page loaded successfully', 'success');

        // Test 2: Check config file access
        fetch('../data/config/theme.json')
            .then(r => {
                if (r.ok) {
                    log('✓ Theme config accessible', 'success');
                    return r.json();
                } else {
                    log('✗ Theme config not accessible: ' + r.status, 'error');
                }
            })
            .then(data => {
                if (data) {
                    log('✓ Theme config loaded: ' + Object.keys(data).length + ' keys', 'success');
                }
            })
            .catch(e => {
                log('✗ Theme config error: ' + e.message, 'error');
            });

        // Test 3: Check CSV file access
        fetch('../data/csv/eq_violations_detailed_test.csv')
            .then(r => {
                if (r.ok) {
                    log('✓ CSV file accessible', 'success');
                } else {
                    log('✗ CSV file not accessible: ' + r.status, 'error');
                }
            })
            .catch(e => {
                log('✗ CSV file error: ' + e.message, 'error');
            });

        // Test 4: Check JS files
        const jsFiles = [
            './js/config-loader.js',
            './js/viobox-system.js',
            './js/app-pro-complete.js'
        ];

        jsFiles.forEach(file => {
            fetch(file)
                .then(r => {
                    if (r.ok) {
                        log('✓ ' + file + ' accessible', 'success');
                    } else {
                        log('✗ ' + file + ' not accessible: ' + r.status, 'error');
                    }
                })
                .catch(e => {
                    log('✗ ' + file + ' error: ' + e.message, 'error');
                });
        });

        // Test 5: Check CSS files
        const cssFiles = [
            './css/core.css',
            './css/layout-pro.css'
        ];

        cssFiles.forEach(file => {
            fetch(file)
                .then(r => {
                    if (r.ok) {
                        log('✓ ' + file + ' accessible', 'success');
                    } else {
                        log('✗ ' + file + ' not accessible: ' + r.status, 'error');
                    }
                })
                .catch(e => {
                    log('✗ ' + file + ' error: ' + e.message, 'error');
                });
        });

        // Test 6: Try loading the actual page in an iframe
        setTimeout(() => {
            log('Attempting to load index-pro.html in iframe...', 'warning');
            const iframe = document.createElement('iframe');
            iframe.src = './index-pro.html';
            iframe.style.width = '100%';
            iframe.style.height = '400px';
            iframe.style.border = '2px solid #666';
            iframe.style.marginTop = '20px';

            iframe.onload = () => {
                log('✓ index-pro.html loaded in iframe', 'success');
            };

            iframe.onerror = (e) => {
                log('✗ iframe error: ' + e, 'error');
            };

            document.body.appendChild(iframe);
        }, 2000);
    </script>
</body>
</html>